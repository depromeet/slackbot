service: dpm-slack-management

provider:
  name: aws
  runtime: python3.6
  profile: default
  region: ap-northeast-2
  stage: prod

plugins:
  - serverless-python-requirements

custom:
  pythonRequirements:
    dockerizePip: true

package:
  exclude:
    - .git/
    - .travis.yml
    - LICENSE
    - README.md
    - tests/
    - .idea/
    - .vscode/
    - __pycache__/

functions:
  root:
    handler: handler.root_handler
    description: 모든 핸들러의 root 입니다. 모든 슬랙봇 명령어를 열람할 수 있는 wiki 의 링크를 리턴합니다.
    events:
      - http:
          path: /
          method: post
      - http:
          path: /
          method: get

  # channels
  archiveInactiveChannels:
    handler: channels/handler.archive_inactive_channels

  sendOffWorkReminder:
    handler: channels/handler.send_off_work_reminder
    description: 매일 오후 6시에 퇴근시간 알림 메시지를 보냅니다.
    events:
      - schedule:
          name: execute-daily-6pm
          description: 매일 오후 6시에 해당 함수를 호출합니다.
          rate: cron(0 9 ? * MON-FRI *)
          enabled: true
      - http:
          path: offwork
          method: get
