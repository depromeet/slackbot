service: dpm-slack-management

provider:
  name: aws
  runtime: python3.6
  profile: default
  region: ap-northeast-2
  stage: prod

functions:
  displayCommands:
    handler: src/handler.display_commands
    description: 모든 명령어를 열람할 수 있는 wiki 링크를 리턴합니다
    events:
      - http:
          path: commands
          method: get

  # 비활성 채널 archive
  archiveInactiveChannels:
    handler: src/channels/archive_inactive.archive_inactive_channels

  # 퇴근 알리미
  sendOffWorkReminder:
    handler: src/channels/off_work.send_off_work_reminder
    description: 매일 오후 6시에 퇴근시간 알림 메시지를 보냅니다.
    events:
      - schedule:
          name: execute-daily-6pm
          description: 매일 오후 6시에 해당 함수를 호출합니다.
          rate: cron(0 9 ? * MON-FRI *)
          enabled: true
      - http:
          path: offwork
          method: get

  # 오늘의 백준 문제
  todayBaekJoon:
    handler: src/boj/handler.boj_problem_fetcher
    description: 백준에서 랜덤하게 알고리즘 문제 한 문제씩 가져옵니다
    events:
      - http:
          path: boj
          method: get
      - http:
          path: boj
          method: post

  # 오늘의 무료책
  todayFreeBook:
    handler: src/packt/handler.free_ebook_fetcher
    description: packtpub 에서 오늘의 무료 e북을 하루에 한번씩 가져옵니다
    events:
      - http:
          path: packt
          method: get
      - schedule:
          name: execute-daily-9pm
          description: 매일 오전 9시에 해당 함수를 호출합니다.
          rate: cron(0 0 ? * MON-FRI *)
          enabled: true

plugins:
  - serverless-python-requirements

custom:
  pythonRequirements:
    dockerizePip: true
